<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>박스 수 계산기 (딱 떨어짐 & 근사치)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 20px auto;
      padding: 10px;
    }

    input {
      width: 100%;
      padding: 8px;
      font-size: 16px;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
    }

    th,
    td {
      border: 1px solid #aaa;
      padding: 8px;
      text-align: center;
    }

    th {
      background: #eee;
    }

    .no-result {
      margin-top: 20px;
      color: red;
    }
  </style>
</head>

<body>

  <h2>1kg / 3kg 박스 수 계산기 (딱 떨어짐 & 근사치 ±5%)</h2>
  <h4>※ 1kg (1박스 16개) + 3kg (1박스 6개)</h4>

  <label for="totalWeight">총 무게 (kg):</label>
  <input type="number" id="totalWeight" min="1" placeholder="총 kg 입력" />

  <div id="result"></div>

  <script>
    function calculateBoxes() {
      const totalWeight = parseInt(document.getElementById('totalWeight').value);
      const resultDiv = document.getElementById('result');
      if (isNaN(totalWeight) || totalWeight <= 0) {
        resultDiv.innerHTML = '<p class="no-result">총 무게를 올바르게 입력하세요.</p>';
        return;
      }

      const box1kg = 16;
      const box3kg = 18;
      const targetRatio = 0.3;
      const tolerance = 0.05; // ±5%

      const max1kgBoxes = Math.floor(totalWeight / box1kg);
      const max3kgBoxes = Math.floor(totalWeight / box3kg);

      let exactMatches = [];
      let approxMatches = [];

      for (let x = 0;x <= max1kgBoxes;x++) {
        for (let y = 0;y <= max3kgBoxes;y++) {
          const weightSum = x * box1kg + y * box3kg;
          if (weightSum === totalWeight) {
            if (x === 0 && y === 0) continue; // 둘 다 0은 의미없음
            const ratio1kg = (x * box1kg) / weightSum;
            const ratio3kg = (y * box3kg) / weightSum;
            if (Math.abs(ratio1kg - targetRatio) <= tolerance) {
              exactMatches.push({ x, y, weightSum, ratio1kg, ratio3kg });
            }
          }
        }
      }

      if (exactMatches.length > 0) {
        exactMatches.sort((a, b) => Math.abs(a.ratio1kg - targetRatio) - Math.abs(b.ratio1kg - targetRatio));
        let html = `<h3>딱 맞는 조합 (1kg 비율 ${((targetRatio - tolerance) * 100).toFixed(0)}% ~ ${((targetRatio + tolerance) * 100).toFixed(0)}%)</h3>`;
        html += '<table><thead><tr><th>1kg 박스 수</th><th>3kg 박스 수</th><th>총 무게(kg)</th><th>1kg 비율(%)</th><th>3kg 비율(%)</th></tr></thead><tbody>';
        for (const m of exactMatches) {
          html += `<tr>
        <td>${m.x}</td>
        <td>${m.y}</td>
        <td>${m.weightSum}</td>
        <td>${(m.ratio1kg * 100).toFixed(2)}</td>
        <td>${(m.ratio3kg * 100).toFixed(2)}</td>
      </tr>`;
        }
        html += '</tbody></table>';
        resultDiv.innerHTML = html;
      } else {
        // 딱 맞는 조합 없으면 ±5% 근사치 범위 내 조합 모두 보여주기
        let approxList = [];
        for (let x = 0;x <= max1kgBoxes;x++) {
          for (let y = 0;y <= max3kgBoxes;y++) {
            if (x === 0 && y === 0) continue;
            const weightSum = x * box1kg + y * box3kg;
            const ratio1kg = (x * box1kg) / weightSum;
            if (Math.abs(ratio1kg - targetRatio) <= tolerance) {
              approxList.push({ x, y, weightSum, ratio1kg });
            }
          }
        }
        if (approxList.length === 0) {
          resultDiv.innerHTML = '<p class="no-result">딱 맞는 조합이나 근사치 조합이 없습니다.</p>';
        } else {
          approxList.sort((a, b) => Math.abs(a.ratio1kg - targetRatio) - Math.abs(b.ratio1kg - targetRatio));
          let html = `<h3>근사치 조합 (1kg 비율 ${((targetRatio - tolerance) * 100).toFixed(0)}% ~ ${((targetRatio + tolerance) * 100).toFixed(0)}%, 무게 정확하지 않음)</h3>`;
          html += '<table><thead><tr><th>1kg 박스 수</th><th>3kg 박스 수</th><th>총 무게(kg)</th><th>1kg 비율(%)</th></tr></thead><tbody>';
          for (const m of approxList) {
            html += `<tr>
          <td>${m.x}</td>
          <td>${m.y}</td>
          <td>${m.weightSum}</td>
          <td>${(m.ratio1kg * 100).toFixed(2)}</td>
        </tr>`;
          }
          html += '</tbody></table>';
          resultDiv.innerHTML = html;
        }
      }
    }

    document.getElementById('totalWeight').addEventListener('input', calculateBoxes);
  </script>

</body>

</html>